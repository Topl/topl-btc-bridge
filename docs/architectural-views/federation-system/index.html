<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-architectural-views/federation-system" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Federation Architecture | Strata Bridge</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://topl.github.io/topl-btc-bridge/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://topl.github.io/topl-btc-bridge/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://topl.github.io/topl-btc-bridge/docs/architectural-views/federation-system"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Federation Architecture | Strata Bridge"><meta data-rh="true" name="description" content="Block Diagram"><meta data-rh="true" property="og:description" content="Block Diagram"><link data-rh="true" rel="icon" href="/topl-btc-bridge/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://topl.github.io/topl-btc-bridge/docs/architectural-views/federation-system"><link data-rh="true" rel="alternate" href="https://topl.github.io/topl-btc-bridge/docs/architectural-views/federation-system" hreflang="en"><link data-rh="true" rel="alternate" href="https://topl.github.io/topl-btc-bridge/docs/architectural-views/federation-system" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/topl-btc-bridge/blog/rss.xml" title="Strata Bridge RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/topl-btc-bridge/blog/atom.xml" title="Strata Bridge Atom Feed"><link rel="stylesheet" href="/topl-btc-bridge/assets/css/styles.00cf9dc1.css">
<script src="/topl-btc-bridge/assets/js/runtime~main.056f2ab4.js" defer="defer"></script>
<script src="/topl-btc-bridge/assets/js/main.c57d7cff.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/topl-btc-bridge/"><div class="navbar__logo"><img src="/topl-btc-bridge/img/logo.svg" alt="Strata Bridge Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/topl-btc-bridge/img/logo.svg" alt="Strata Bridge Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Strata Bridge</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/topl-btc-bridge/docs/intro">Architecture</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Topl/topl-btc-bridge" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/topl-btc-bridge/docs/intro">Architecture Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/topl-btc-bridge/docs/category/views">Views</a><button aria-label="Collapse sidebar category &#x27;Views&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/topl-btc-bridge/docs/architectural-views/repo-layout">Repository Layout</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/topl-btc-bridge/docs/architectural-views/state-machine">Monitor State Machine</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/topl-btc-bridge/docs/architectural-views/federation-system">Federation Architecture</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/topl-btc-bridge/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/topl-btc-bridge/docs/category/views"><span itemprop="name">Views</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Federation Architecture</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Federation Architecture</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="block-diagram">Block Diagram<a href="#block-diagram" class="hash-link" aria-label="Direct link to Block Diagram" title="Direct link to Block Diagram">​</a></h2>
<p>The following diagram shows the architecture of the federation system:</p>
<p><img decoding="async" loading="lazy" alt="Block Diagram" src="/topl-btc-bridge/assets/images/blockDiagram-e4b6e31dd6c84c7fbac55262f5cc3a6b.svg" width="1598" height="827" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="components">Components<a href="#components" class="hash-link" aria-label="Direct link to Components" title="Direct link to Components">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="brdge-federation">brdge-federation<a href="#brdge-federation" class="hash-link" aria-label="Direct link to brdge-federation" title="Direct link to brdge-federation">​</a></h3>
<p>The bridge federation it self is composed by a set of one or more <code>strata-bridge</code>
nodes. It has also two properties: <code>clientCount</code> and <code>replicaCount</code>. The <code>clientCount</code>
is the number of clients that can connect to the federation. The <code>replicaCount</code> is the
number of replicas that the federation has.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="strata-bridge">strata-bridge<a href="#strata-bridge" class="hash-link" aria-label="Direct link to strata-bridge" title="Direct link to strata-bridge">​</a></h3>
<p>The <code>strata-bridge</code> is a node that is part of the federation. It is responsible for
reaching consensus on the state of the federation. It is composed by the following:</p>
<ul>
<li><strong>consensus</strong>: This is a subsystem that run autonomously and is responsible for
reaching consensus on the state of the federation using the PBFT algorithm.</li>
<li><strong>public-api</strong>: This is a subsystem that is responsible for handling requests from
the clients and interacting with the consensus layer.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="public-api">public-api<a href="#public-api" class="hash-link" aria-label="Direct link to public-api" title="Direct link to public-api">​</a></h3>
<p>The public API is a client to the consensus layer. It exposes a REST API <code>BridgeJSONAPI</code> to the users.
It is a PBFT client. It knows all the replicas and interacts with them according
to the PBFT protocol.</p>
<p>As a standard client, it exposes a <code>ResponseService</code> that is responsible for handling
the responses from the replicas.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="consensus">consensus<a href="#consensus" class="hash-link" aria-label="Direct link to consensus" title="Direct link to consensus">​</a></h3>
<p>The consensus layer has two parts:</p>
<ul>
<li><strong>core</strong>: This package contains the PBFT consensus algorithm. It is responsible for
reaching consensus on the state of the federation.</li>
<li><strong>subsystems</strong>: This package contains the monitoring subsystem. It is responsible for
monitoring the blockchain and updating the state of the federation.</li>
</ul>
<p>It has assigned a <code>replicaId</code> that is used to identify the replica in the federation,
and a <code>clientId</code> that is used to identify the <code>monitor</code> in the federation as
another normal client.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="core">core<a href="#core" class="hash-link" aria-label="Direct link to core" title="Direct link to core">​</a></h3>
<p>The core package has access to an external database that is used to store the
PBFT log. It is responsible for reaching consensus, and manages also
the state of the node. If has a PBFT client to respond to the requests from the
<code>public-api</code> and the <code>monitor</code>.</p>
<p>This system also offers a <code>StateMachineGrpcServiceServer</code> that is responsible for
handling the requests from the <code>public-api</code> and the <code>monitor</code> to update the state
of the state machine.</p>
<p>The state machine service is provided by the <code>StateMachineService</code> interface.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="monitor">monitor<a href="#monitor" class="hash-link" aria-label="Direct link to monitor" title="Direct link to monitor">​</a></h3>
<p>The monitor is a client that is responsible for monitoring the blockchain and updating
the state of the federation. It is a PBFT client. It knows all the replicas and interacts
with them according to the PBFT protocol.</p>
<p>It also knows the Bitcoin network and the Strata network. It monitors them,
changes its state accordingly and then updates the state of the federation
via the <code>StateMachineService</code> interface.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/topl-btc-bridge/docs/architectural-views/state-machine"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Monitor State Machine</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#block-diagram" class="table-of-contents__link toc-highlight">Block Diagram</a></li><li><a href="#components" class="table-of-contents__link toc-highlight">Components</a><ul><li><a href="#brdge-federation" class="table-of-contents__link toc-highlight">brdge-federation</a></li><li><a href="#strata-bridge" class="table-of-contents__link toc-highlight">strata-bridge</a></li><li><a href="#public-api" class="table-of-contents__link toc-highlight">public-api</a></li><li><a href="#consensus" class="table-of-contents__link toc-highlight">consensus</a></li><li><a href="#core" class="table-of-contents__link toc-highlight">core</a></li><li><a href="#monitor" class="table-of-contents__link toc-highlight">monitor</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/topl-btc-bridge/docs/intro">Architecture</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/topl_protocol" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/Topl/topl-btc-bridge" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Strata, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>